<html>
	<head>
		<center><h1 class='center'>IP Geolocation</h1></center>
		<center><div id='div0' class='center'></div></center>
		<center><h1 class='center'>Countries</h1></center>
		<center><div id='div1' class='center'></div></center>
		<center><h1 class='center'>Top 10 IPs</h1></center>
		<center><div id='div2' class='center'></div></center>
		<center><h1 class='center'>Top 10 Countries</h1></center>
		<center><div id='div3' class='center'></div></center>

		<script type="text/javascript" src="loader.js"></script>
		<script type="text/javascript" src="jsapi.js"></script>
		<script>

		var json={"country_f":{"BD":1,"RU":3,"FR":14,"NL":31,"CN":2740,"AG":1,"unknown":50,"DE":43,"IT":5,"US":69,"KR":350,"VN":13,"TH":2,"IN":36,"UA":5,"GB":9},"gps_f":{"21.0333,105.85":13,"33.6119,-111.8906":3,"35.0,105.0":24,"64.8378,-147.7164":4,"38.0,-97.0":7,"52.3667,4.9":18,"51.5333,0.7":3,"13.75,100.4667":2,"37.5985,126.9783":3,"31.0456,121.3997":32,"34.6836,113.5325":5,"42.8333,12.8333":5,"51.65,6.1833":8,"unknown":50,"29.5628,106.5528":6,"51.0,9.0":35,"17.05,-61.8":1,"50.45,30.5233":5,"34.2583,108.9286":6,"41.1271,-73.4416":3,"32.8897,-117.1336":5,"32.7831,-96.8067":10,"42.8864,-78.8784":6,"37.3394,-121.895":5,"51.5,-0.13":6,"52.374,4.8897":13,"57.7665,40.9269":1,"28.6667,77.2167":36,"30.2936,120.1614":158,"30.5801,114.2734":3,"55.75,37.6166":2,"37.57,126.98":347,"39.1472,-94.5735":6,"23.1167,113.25":1394,"39.9289,116.3883":2,"31.8639,117.2808":4,"39.8897,115.275":4,"32.0617,118.7778":1079,"36.6683,116.9972":12,"48.86,2.35":14,"33.9224,-117.2476":20,"41.7922,123.4328":11,"23.7,90.375":1},"gps_p":{"64.8378,-147.7164":42},"country_p":{"US":42},"ip_f":{"66.181.5.18":5,"103.22.189.34":5,"222.186.21.217":164,"117.145.177.164":8,"58.218.205.101":85,"61.132.161.130":4,"58.218.211.11":72,"58.218.204.211":33,"111.207.179.16":2,"185.130.5.208":6,"125.88.177.95":6,"58.218.204.107":50,"58.218.199.166":79,"40.118.163.148":4,"212.129.8.145":3,"185.110.132.54":32,"202.99.172.155":4,"117.34.70.143":4,"222.186.56.138":17,"144.76.102.242":35,"123.25.21.23":4,"62.138.2.209":8,"222.186.34.163":11,"27.221.10.43":4,"198.23.82.194":5,"193.201.227.191":5,"116.246.27.145":28,"58.218.205.69":1,"13.92.183.81":3,"137.229.78.5":2,"137.229.78.7":1,"206.214.15.25":1,"218.56.162.213":8,"125.88.146.130":238,"208.67.1.57":6,"115.28.159.149":20,"164.132.160.210":5,"195.154.52.9":1,"183.3.202.175":1106,"115.28.76.112":116,"159.253.153.210":4,"159.253.153.212":4,"185.130.5.86":5,"180.151.30.102":36,"58.103.4.7":3,"217.112.92.36":6,"69.4.81.26":6,"169.45.4.26":15,"113.207.7.3":6,"61.147.88.44":4,"146.0.77.33":3,"185.106.92.148":6,"27.254.67.185":2,"159.122.220.224":3,"212.129.26.190":3,"221.229.162.7":44,"58.218.204.30":101,"108.13.176.75":20,"58.218.211.244":82,"121.201.62.254":44,"117.1.223.53":3,"58.218.204.248":107,"222.186.56.42":143,"202.114.72.243":3,"185.112.102.160":1,"112.54.83.98":6,"59.47.5.242":11,"220.88.41.2":5,"91.193.74.33":2,"222.186.56.171":11,"5.153.17.178":5,"14.63.221.39":342,"58.218.205.97":53,"163.172.10.101":3,"222.186.34.72":22,"125.212.232.99":2,"60.191.74.83":22,"212.83.148.113":7,"137.229.25.194":1,"27.147.218.178":1,"222.73.119.253":4,"113.183.0.27":4,"117.145.177.52":10,"66.228.120.51":10,"125.76.238.39":2,"192.169.255.185":3,"46.42.37.66":1},"users_p":{"null":42},"users_f":{"test1":6,"jira":2,"test2":1,"office":1,"consul":1,"tcs":2,"jerry":1,"mysql":6,"nasa123":1,"emily":1,"web":3,"samba":3,"ec2-user":1,"jay":1,"securityagent":1,"ts":4,"0":1,"zhangyan":1,"tst":1,"b":1,"bin":1,"marco":1,"ftpuser":6,"prueba":4,"teamspeak":6,"applmgr":1,"hunter":1,"ftp1":5,"biz":2,"jack":2,"linda":1,"alex":3,"atendimento":1,"mythtv":2,"eva":1,"marry":1,"D-Link":3,"ryan":1,"server":4,"zabbix":1,"man":1,"deathrun":3,"wemaster":1,"amanda":2,"steam":1,"www":2,"sync":1,"cron":1,"syslog":1,"teamspeak3":1,"teamspeak2":1,"123456":1,"victor":1,"ftp":4,"matt":1,"icinga":1,"webftp":1,"multimedia":1,"toto":1,"veeambackup":1,"backuppc":2,"daniel":1,"melissa":1,"ftpadmin":1,"hostmaster":1,"cgi":1,"administrateur":1,"ts3bot":1,"plex":1,"yuri":1,"ubuntu":2,"apache":4,"super":1,"dominic":1,"david":3,"rdp":1,"rds":2,"dario":1,"cloud-user":1,"ts3":7,"vbox":1,"anon":1,"karim":2,"sysop":1,"backup":2,"op":1,"amber":1,"point":1,"app":1,"rachel":1,"socks":1,"jesus":1,"marina":2,"exploit":2,"shutdown":1,"steven":1,"gnats":1,"miss":1,"numerge":1,"git":12,"guest":6,"mndms":1,"to":1,"support":12,"scan":1,"jetty":1,"debian":2,"lwh":1,"redmine":4,"master":1,"dup":1,"andy":1,"pi":12,"tcpdump":1,"cactiuser":1,"username":1,"a":5,"shell":2,"tester":1,"shane":2,"csgo":2,"nagios":10,"webmaster":1,"info":2,"yves":2,"none":2,"john":1,"aaa":1,"temp":5,"travis":1,"testtest":1,"bill":1,"dev":2,"project":1,"admin":35,"suport":1,"avahi":1,"Fake":1,"sophie":2,"root":2885,"user01":2,"test123":1,"user2":1,"angel":1,"user1":3,"demo":2,"site":1,"csgoserver":2,"dspace":1,"null":4,"kevin":1,"postgres":5,"testuser":2,"servercsgo":1,"vagrant":6,"hadoop":4,"ADMIN":19,"weblogic":2,"test":25,"jenkins":1,"ubnt":12,"sysadmin":1,"vnc":3,"deploy":6,"Admin":4,"fwefewfe":1,"sys":1,"user":16,"student":2,"kaz":2,"php":2,"stack":2,"fedora":1,"ghost":4,"danny":1,"00089":1,"tomcat":5,"curis":1,"minecraft":2,"zenoss":1,"gpadmin":1,"www-data":3,"oracle":18,"oprofile":1,"pruebas":1},"ip_p":{"137.229.78.5":5,"137.229.78.7":18,"137.229.78.0":1,"137.229.25.194":18}};
		google.charts.load('current',{'packages':['corechart','geochart']});
		google.charts.setOnLoadCallback(draw_charts);

		function draw_charts(json)
		{
			var xmlhttp=new XMLHttpRequest();
			xmlhttp.overrideMimeType("application/json");
			xmlhttp.open('GET','auth.json?'+(new Date()).getMilliseconds(),true);
			xmlhttp.onreadystatechange=function()
			{
				if(xmlhttp.readyState==4&&xmlhttp.status==200)
				{
					var json=JSON.parse(xmlhttp.responseText);
					draw_gps(json);
					draw_country(json);
					draw_ip_top(json,10);
					draw_country_top(json,10);
				}
			};
			xmlhttp.send(null);
		}

		function draw_gps(json)
		{
			var div=document.getElementById('div0');
			var countries=[['Latitude','Longitude','Incidents']];
			for(var key in json['gps_f'])
				if(key!='unknown')
				{
					var json_str='['+key+']';

					var coord=JSON.parse(json_str);
					var entry=[coord[0],coord[1],json['gps_f'][key]];
					countries.push(entry);
				}
			var data=google.visualization.arrayToDataTable(countries);
			var options=
			{
				width:600,
				legend:'none',
				colorAxis:{colors:['yellow','red']},
				displayMode:'markers'
			};
			var chart=new google.visualization.GeoChart(div);
			chart.draw(data,options);
		}

		function draw_country(json)
		{
			var div=document.getElementById('div1');
			var countries=[['Country','Incidents']];
			for(var key in json['country_f'])
				if(key!='unknown')
					countries.push([key,json['country_f'][key]]);
			var data=google.visualization.arrayToDataTable(countries);
			var options=
			{
				width:600,
				legend:'none',
				colorAxis:{colors:['yellow','red']},
			};
			var chart=new google.visualization.GeoChart(div);
			chart.draw(data,options);
		}

		function draw_ip_top(json,num)
		{
			var div=document.getElementById('div2');
			var ips=[];
			for(var key in json['ip_f'])
				ips.push([key,json['ip_f'][key]]);
			ips.sort(function(a,b){return b[1]-a[1]});
			if(ips.length>num)
				ips.length=num;
			ips.splice(0,0,['IP','Incidents']);
			var data=google.visualization.arrayToDataTable(ips);
			var options=
			{
				height:400,
				pieHole:0.4
			};
			var chart=new google.visualization.PieChart(div);
			chart.draw(data,options);
		}

		function draw_country_top(json,num)
		{
			var div=document.getElementById('div3');
			var countries=[];
			for(var key in json['country_f'])
				if(key!='unknown')
					countries.push([key,json['country_f'][key]]);
			countries.sort(function(a,b){return b[1]-a[1]});
			if(countries.length>num)
				countries.length=num;
			countries.splice(0,0,['Country','Incidents']);
			var data=google.visualization.arrayToDataTable(countries);
			var options=
			{
				height:400,
				pieHole:0.4
			};
			var chart=new google.visualization.PieChart(div);
			chart.draw(data,options);
		}
		</script>
	</head>
	<body>
	</body>
</html